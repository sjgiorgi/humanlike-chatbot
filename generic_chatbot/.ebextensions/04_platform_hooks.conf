files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/01_nginx_upload_limit.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # This script runs after the application is deployed
      
      # Add nginx upload limit configuration
      echo "client_max_body_size 10M;" > /etc/nginx/conf.d/upload_limit.conf
      
      # Also add to main nginx config if not already present
      if ! grep -q "client_max_body_size" /etc/nginx/nginx.conf; then
        sed -i '/server {/a\        client_max_body_size 10M;' /etc/nginx/nginx.conf
      fi
      
      # Test and reload nginx
      nginx -t && service nginx reload
      
      echo "Nginx upload limit configured successfully"
